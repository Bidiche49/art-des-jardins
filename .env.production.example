# ===========================================
# Art & Jardin - Production Environment
# ===========================================
# Copy this file to .env and fill in the values
# NEVER commit .env to git!
#
# Variables marquees [REQUIRED] sont obligatoires
# Variables marquees [OPTIONAL] ont des valeurs par defaut
# ===========================================

# -----------------------------
# Domain Configuration
# -----------------------------
DOMAIN=artjardin.fr
ACME_EMAIL=contact@artjardin.fr

# -----------------------------
# Database (PostgreSQL)
# -----------------------------
POSTGRES_USER=artjardin
POSTGRES_PASSWORD=<GENERATE_STRONG_PASSWORD>                # [REQUIRED] openssl rand -base64 32
POSTGRES_DB=artjardin_prod
DATABASE_URL=postgresql://artjardin:<PASSWORD>@postgres:5432/artjardin_prod  # [REQUIRED]

# -----------------------------
# API Server
# -----------------------------
NODE_ENV=production
API_PORT=3000
API_HOST=0.0.0.0
APP_URL=https://api.artjardin.fr                            # [REQUIRED] URL publique de l'API

# -----------------------------
# JWT Authentication
# -----------------------------
JWT_SECRET=<GENERATE_64_CHAR_SECRET>                        # [REQUIRED] openssl rand -base64 64
JWT_EXPIRES_IN=15m
JWT_REFRESH_EXPIRES_IN=7d

# -----------------------------
# Two-Factor Authentication
# -----------------------------
TWO_FACTOR_ENCRYPTION_KEY=<GENERATE_32_CHAR_SECRET>         # [REQUIRED] openssl rand -base64 32
TWO_FACTOR_REQUIRED_ROLES=patron

# -----------------------------
# Device Tracking
# -----------------------------
DEVICE_ACTION_SECRET=<GENERATE_32_CHAR_SECRET>              # [REQUIRED] openssl rand -base64 32

# -----------------------------
# CORS & Security
# -----------------------------
CORS_ORIGINS=https://artjardin.fr,https://app.artjardin.fr  # [REQUIRED] Domaines autorises, separes par virgule
THROTTLE_TTL=60                                             # [OPTIONAL] Fenetre rate-limiting en secondes
THROTTLE_LIMIT=100                                          # [OPTIONAL] Requetes max par fenetre

# -----------------------------
# Session Timeouts (minutes)
# -----------------------------
SESSION_IDLE_TIMEOUT_PATRON=30
SESSION_IDLE_TIMEOUT_EMPLOYE=120
SESSION_IDLE_TIMEOUT_CLIENT=60

# -----------------------------
# S3 Storage (Scaleway Object Storage)
# -----------------------------
S3_ENDPOINT=https://s3.fr-par.scw.cloud                    # [REQUIRED]
S3_ACCESS_KEY=<SCALEWAY_ACCESS_KEY>                         # [REQUIRED]
S3_SECRET_KEY=<SCALEWAY_SECRET_KEY>                         # [REQUIRED]
S3_BUCKET=artjardin-prod                                    # [REQUIRED]
S3_REGION=fr-par
BACKUP_BUCKET=artjardin-backups                             # [OPTIONAL] Bucket pour les sauvegardes
ARCHIVE_BUCKET=artjardin-archives                           # [OPTIONAL] Bucket pour les archives

# -----------------------------
# SMTP (Email - Brevo)
# -----------------------------
SMTP_HOST=smtp-relay.brevo.com                              # [REQUIRED]
SMTP_PORT=587
SMTP_USER=<BREVO_SMTP_KEY>                                  # [REQUIRED]
SMTP_PASSWORD=<BREVO_SMTP_PASSWORD>                         # [REQUIRED]
SMTP_FROM="Art des Jardins <contact@artjardin.fr>"          # [REQUIRED]
COMPANY_BCC_EMAIL=artdesjardins49@gmail.com                 # [OPTIONAL] Copie cachee sur chaque email
CONTACT_RECIPIENT_EMAIL=artdesjardins49@gmail.com           # [REQUIRED] Destinataire formulaire contact

# -----------------------------
# Backup & Retention
# -----------------------------
BACKUP_ENABLED=true
BACKUP_ENCRYPTION_KEY=<GENERATE_32_CHAR_SECRET>             # [REQUIRED] openssl rand -base64 32
BACKUP_RETENTION_DAYS=30
SOFT_DELETE_RETENTION_DAYS=90

# -----------------------------
# Automatic Reminders (Relances devis)
# -----------------------------
RELANCE_ENABLED=true
RELANCE_J1=30                                               # [OPTIONAL] Jours avant 1ere relance
RELANCE_J2=45                                               # [OPTIONAL] Jours avant 2eme relance
RELANCE_J3=60                                               # [OPTIONAL] Jours avant 3eme relance
AUTO_SEND_ENABLED=false                                     # [OPTIONAL] Envoi automatique des relances

# -----------------------------
# Alerts & Monitoring
# -----------------------------
ALERTS_ENABLED=true
ALERTS_EMAIL=artdesjardins49@gmail.com                      # [REQUIRED si ALERTS_ENABLED=true]
SERVICE_DOWN_THRESHOLD=300000                                # [OPTIONAL] Seuil en ms (5 min)
SECURITY_ALERT_THRESHOLD=5                                  # [OPTIONAL] Tentatives avant alerte
SECURITY_ALERT_WINDOW_MINUTES=10
SECURITY_ALERT_EMAIL=artdesjardins49@gmail.com              # [OPTIONAL]

# -----------------------------
# Push Notifications (VAPID)
# -----------------------------
# Generate with: npx web-push generate-vapid-keys
VAPID_PUBLIC_KEY=<VAPID_PUBLIC_KEY>                          # [OPTIONAL] Activer push notifications
VAPID_PRIVATE_KEY=<VAPID_PRIVATE_KEY>                       # [OPTIONAL]
VAPID_SUBJECT=mailto:contact@artjardin.fr

# -----------------------------
# Client Portal & Signature
# -----------------------------
PORTAL_URL=https://portail.artjardin.fr                     # [OPTIONAL] URL portail client
FRONTEND_URL=https://artjardin.fr                           # [REQUIRED] URL site vitrine
PATRON_EMAIL=artdesjardins49@gmail.com                      # [REQUIRED] Email du patron (notifications signature)

# -----------------------------
# Calendar Integrations (optionnel)
# -----------------------------
# GOOGLE_CLIENT_ID=<GOOGLE_OAUTH_CLIENT_ID>
# GOOGLE_CLIENT_SECRET=<GOOGLE_OAUTH_CLIENT_SECRET>
# GOOGLE_REDIRECT_URI=https://api.artjardin.fr/api/v1/integrations/google/callback
# MICROSOFT_CLIENT_ID=<MICROSOFT_OAUTH_CLIENT_ID>
# MICROSOFT_CLIENT_SECRET=<MICROSOFT_OAUTH_CLIENT_SECRET>
# MICROSOFT_REDIRECT_URI=https://api.artjardin.fr/api/v1/integrations/microsoft/callback

# -----------------------------
# GeoIP (optionnel)
# -----------------------------
GEOIP_CACHE_HOURS=24
GEOIP_TIMEOUT_MS=2000

# -----------------------------
# Logging
# -----------------------------
LOG_LEVEL=warn                                              # [OPTIONAL] error|warn|info|debug

# -----------------------------
# Traefik (reverse proxy)
# -----------------------------
TRAEFIK_LOG_LEVEL=WARN
# Generate with: htpasswd -nb admin <password>
TRAEFIK_DASHBOARD_AUTH=admin:<HTPASSWD_HASH>                # [OPTIONAL] Dashboard Traefik

# -----------------------------
# Site Vitrine (Next.js)
# -----------------------------
NEXT_PUBLIC_WEB3FORMS_KEY=<WEB3FORMS_API_KEY>               # [REQUIRED] Cle API Web3Forms
NEXT_PUBLIC_PLAUSIBLE_DOMAIN=artjardin.fr
NEXT_PUBLIC_API_URL=https://api.artjardin.fr
