# BUG-002: Secret JWT avec fallback hardcode en production

**Type:** Bug
**Statut:** A faire
**Priorite:** Critique
**Complexite:** XS
**Tags:** security, api, auth
**Date creation:** 2026-02-12

---

## Description

Dans `auth.module.ts`, le secret JWT a un fallback hardcode :
```typescript
secret: configService.get<string>('JWT_SECRET') || 'dev-secret-change-in-production',
```

Si `JWT_SECRET` n'est pas defini en production, tous les tokens sont signes avec un secret connu publiquement (visible dans le code source). Compromission totale de l'authentification.

## Reproduction

1. Ouvrir `apps/api/src/modules/auth/auth.module.ts:22`
2. Constater le fallback `'dev-secret-change-in-production'`
3. Si JWT_SECRET absent en prod â†’ tokens forgeables par n'importe qui

## Criteres d'acceptation

- [ ] Fallback JWT secret supprime
- [ ] L'app crash au demarrage si `JWT_SECRET` absent
- [ ] Schema Joi de validation env inclut `JWT_SECRET` en required
- [ ] Meme traitement pour `JWT_REFRESH_SECRET` si existant
- [ ] Tests de demarrage valides

## Fichiers concernes

- `apps/api/src/modules/auth/auth.module.ts:22` - supprimer fallback
- `apps/api/src/config/env.validation.ts` - verifier JWT_SECRET required

## Analyse / Approche

```typescript
// auth.module.ts - Supprimer le fallback
secret: configService.getOrThrow<string>('JWT_SECRET'),

// OU si getOrThrow n'est pas disponible
const secret = configService.get<string>('JWT_SECRET');
if (!secret) throw new Error('JWT_SECRET must be defined');
```

## Tests de validation

- [ ] App demarre normalement avec JWT_SECRET defini
- [ ] App crash avec message clair si JWT_SECRET absent
- [ ] Pas de fallback dans le code source
