# BUG-015: Providers ne reagissent pas aux sync events (4 modules)

**Type:** Bug
**Statut:** A faire
**Priorite:** Critique
**Complexite:** S
**Tags:** mobile, offline, sync, ui
**Date creation:** 2026-02-26

---

## Description

Seul `DevisListNotifier` ecoute le `syncEventStream` pour se rafraichir automatiquement apres sync. Les 4 autres modules (clients, chantiers, interventions, factures) ne le font pas. L'utilisateur doit faire un pull-to-refresh manuel pour voir les donnees synchronisees.

## Modules concernes

| Module | Provider | Ecoute syncEvents ? |
|--------|----------|---------------------|
| Devis | `devisListNotifierProvider` | Oui |
| Clients | `clientsListNotifierProvider` | **Non** |
| Chantiers | `chantiersListNotifierProvider` | **Non** |
| Interventions | `interventionsWeekNotifierProvider` | **Non** |
| Factures | `facturesListNotifierProvider` | **Non** |
| Dashboard | `dashboardNotifierProvider` | **Non** |
| Calendrier | `calendarNotifierProvider` | **Non** |

## Fichiers concernes

### A modifier
- `apps/mobile/lib/features/clients/presentation/providers/clients_providers.dart`
- `apps/mobile/lib/features/chantiers/presentation/providers/chantiers_providers.dart`
- `apps/mobile/lib/features/interventions/presentation/providers/interventions_providers.dart`
- `apps/mobile/lib/features/factures/presentation/providers/factures_providers.dart`
- `apps/mobile/lib/features/dashboard/presentation/providers/dashboard_providers.dart`
- `apps/mobile/lib/features/calendar/presentation/providers/calendar_providers.dart`

## Approche

Suivre le pattern de `DevisListNotifier` :
1. Ajouter `Stream<SyncEvent>` en parametre du constructeur
2. S'abonner au stream dans le constructeur
3. Quand un event correspond a l'entite du module → appeler `load()`
4. Annuler la souscription dans `dispose()`

## Criteres d'acceptation

- [ ] Chaque ListNotifier ecoute `syncEventStream` et filtre sur son entite
- [ ] Apres sync d'un client → liste clients se recharge
- [ ] Apres sync d'un chantier → liste chantiers se recharge
- [ ] Apres sync d'une intervention → liste interventions + calendrier se rechargent
- [ ] Apres sync d'une facture → liste factures se recharge
- [ ] Dashboard se recharge apres tout type de sync

## Tests de validation

- [ ] Test par module : sync event emis → load() appele
- [ ] Test : sync event d'une autre entite → load() PAS appele
- [ ] Test : dispose annule la souscription
- [ ] Adapter les tests existants pour passer le stream en parametre
