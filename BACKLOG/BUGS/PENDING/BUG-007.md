# BUG-007: CORS en dev autorise toutes les origines

**Type:** Bug
**Statut:** A faire
**Priorite:** Moyenne
**Complexite:** XS
**Tags:** security, api
**Date creation:** 2026-02-12

---

## Description

Dans `main.ts`, la config CORS en dev utilise `origin: true` ce qui autorise TOUTE origine a faire des requetes avec credentials. Meme en dev, c'est un risque de CSRF si le poste dev est expose.

```typescript
origin: process.env.NODE_ENV === 'production'
  ? (process.env.CORS_ORIGINS?.split(',') || [])
  : true,
```

## Criteres d'acceptation

- [ ] CORS en dev restreint a une whitelist explicite
- [ ] Whitelist : `http://localhost:3000`, `http://localhost:3001`, `http://localhost:5173`

## Fichiers concernes

- `apps/api/src/main.ts:63-68`

## Analyse / Approche

```typescript
origin: process.env.NODE_ENV === 'production'
  ? (process.env.CORS_ORIGINS?.split(',') || [])
  : ['http://localhost:3000', 'http://localhost:3001', 'http://localhost:5173'],
```

## Tests de validation

- [ ] Requete depuis localhost:3000 → acceptee
- [ ] Requete depuis localhost:5173 → acceptee
- [ ] Requete depuis autre origine → refusee
