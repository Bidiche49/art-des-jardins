# BUG-013: AutoSync jamais demarre — sync automatique inexistante

**Type:** Bug
**Statut:** A faire
**Priorite:** Critique
**Complexite:** XS
**Tags:** mobile, offline, sync
**Date creation:** 2026-02-26

---

## Description

`autoSyncProvider` et `ConnectivityService.startListening()` ne sont jamais appeles. Le sync automatique au retour en ligne **n'existe pas**. Les donnees creees offline restent indefiniment dans la queue sans jamais etre envoyees au serveur.

C'est le bug transversal le plus critique : sans auto-sync, AUCUN module ne synchronise automatiquement.

## Cause racine

Le provider `autoSyncProvider` est defini dans `sync_providers.dart` (lignes 52-61) avec un `AutoSyncController.start()` qui ecoute les changements de connectivite. Mais **aucun widget ni provider ne fait `ref.read(autoSyncProvider)`**, donc le controller n'est jamais instancie.

## Fichiers concernes

### A modifier
- `apps/mobile/lib/shared/layouts/app_shell.dart` — Ajouter `ref.read(autoSyncProvider).start()` dans `initState()`
- `apps/mobile/lib/services/sync/sync_providers.dart` — Verifier que `autoSyncProvider` est correctement configure

## Criteres d'acceptation

- [ ] `AutoSyncController.start()` est appele au demarrage de l'app (dans `AppShell.initState()`)
- [ ] `ConnectivityService.startListening()` est appele
- [ ] Au retour en ligne, `syncAll()` est declenche automatiquement (avec debounce 1s)
- [ ] Les operations en queue sont envoyees au serveur sans action manuelle
- [ ] Les tests existants ne cassent pas

## Tests de validation

- [ ] Test : demarrer l'app → autoSync est actif
- [ ] Test : passer offline → creer donnee → repasser online → donnee synchronisee automatiquement
- [ ] Test : pas de double sync si connectivite flap rapidement (debounce)
