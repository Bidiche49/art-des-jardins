# IMP-001: Helmet.js + Headers CSP

**Type:** Improvement
**Statut:** Pret
**Priorite:** Critique
**Complexite:** XS
**Tags:** security, api
**Date creation:** 2026-02-03
**Phase:** 11

---

## Description

Ajouter Helmet.js au backend NestJS pour configurer automatiquement les headers de securite HTTP (CSP, X-Frame-Options, HSTS, etc.).

## Contexte

Les headers de securite HTTP sont une protection de base contre :
- XSS (Content-Security-Policy)
- Clickjacking (X-Frame-Options)
- MIME sniffing (X-Content-Type-Options)
- Downgrade attacks (Strict-Transport-Security)

Helmet.js est le standard pour Express/NestJS.

## Criteres d'acceptation

- [ ] Helmet.js installe et configure dans main.ts
- [ ] CSP configure pour bloquer inline scripts (sauf nonce)
- [ ] HSTS active avec max-age 1 an
- [ ] X-Frame-Options: DENY
- [ ] X-Content-Type-Options: nosniff
- [ ] Referrer-Policy: strict-origin-when-cross-origin
- [ ] Tests de verification des headers

## Fichiers concernes

- `apps/api/src/main.ts`
- `apps/api/package.json`

## Analyse / Approche

```typescript
// main.ts
import helmet from 'helmet';

app.use(helmet({
  contentSecurityPolicy: {
    directives: {
      defaultSrc: ["'self'"],
      scriptSrc: ["'self'"],
      styleSrc: ["'self'", "'unsafe-inline'"],
      imgSrc: ["'self'", "data:", "https:"],
    }
  },
  hsts: { maxAge: 31536000, includeSubDomains: true }
}));
```

## Tests de validation

- [ ] Curl -I sur /api/health retourne tous les headers securite
- [ ] CSP bloque un script inline malveillant
- [ ] Site fonctionne normalement avec les restrictions
