# IMP-042: Ajouter security headers et cache headers dans next.config

**Type:** Improvement
**Statut:** Fait
**Priorite:** Moyenne
**Complexite:** S
**Tags:** vitrine, security, perf, seo
**Date creation:** 2026-02-13

---

## Description

Le fichier `next.config.js` ne definit aucun header de securite ni de cache. Les headers de securite protegent contre les attaques XSS, clickjacking, etc. Les headers de cache ameliorent les performances et le score Lighthouse.

**Note** : En mode `output: 'export'`, les headers Next.js ne sont pas generes. Ils doivent etre configures au niveau du serveur web (Nginx, Cloudflare, etc.). Ce ticket peut quand meme preparer la config pour le mode `standalone` (Docker).

## Fichiers concernes

- `apps/vitrine/next.config.js`
- Ou la config du serveur web de production (Nginx, Cloudflare Pages)

## Approche

### Pour le mode standalone (Docker) :
```javascript
const nextConfig = {
  // ... config existante
  async headers() {
    return [
      {
        source: '/(.*)',
        headers: [
          { key: 'X-Content-Type-Options', value: 'nosniff' },
          { key: 'X-Frame-Options', value: 'DENY' },
          { key: 'X-XSS-Protection', value: '1; mode=block' },
          { key: 'Referrer-Policy', value: 'strict-origin-when-cross-origin' },
          { key: 'Permissions-Policy', value: 'camera=(), microphone=(), geolocation=()' },
        ],
      },
      {
        source: '/images/(.*)',
        headers: [
          { key: 'Cache-Control', value: 'public, max-age=31536000, immutable' },
        ],
      },
    ];
  },
};
```

### Pour Cloudflare Pages / Nginx :
Documenter les headers a configurer dans un fichier `_headers` (Cloudflare) ou dans la config Nginx.

## Criteres d'acceptation

- [ ] Headers de securite configures
- [ ] Headers de cache pour les assets statiques (images, CSS, JS)
- [ ] Documentation pour la config en production

## Tests de validation

- [ ] Verifier les headers avec curl -I
- [ ] Score securite sur securityheaders.com
- [ ] Lighthouse Performance score
