# IMP-005: Detection anomalies login

**Type:** Improvement
**Statut:** Split
**Priorite:** Moyenne
**Complexite:** M
**Tags:** security, auth
**Date creation:** 2026-02-03
**Date cloture:** 2026-02-03
**Phase:** 12
**Automatisable:** OUI (avec attention)

---

## SPLIT EN SOUS-TICKETS

Ce ticket a ete decoupe en 4 sous-tickets pour une meilleure granularite:

| Sous-ticket | Description | Complexite |
|-------------|-------------|------------|
| IMP-005-A | Modele KnownDevice et tracking fingerprint | S |
| IMP-005-B | Service geolocalisation IP | S |
| IMP-005-C | Email alerte nouveau device + actions | S |
| IMP-005-D | Historique connexions et revocation devices | S |

**Ordre d'execution:** A -> B -> C -> D (dependances sequentielles)

---

## Description originale

Detecter et alerter lors de connexions depuis une nouvelle IP, un nouveau device, ou un nouveau pays.

## User Story

**En tant que** patron
**Je veux** etre alerte si quelqu'un se connecte a mon compte depuis un nouvel appareil
**Afin de** detecter rapidement une compromission de compte

## Criteres d'acceptation (distribues dans sous-tickets)

- [x] Stocker les devices connus par utilisateur (fingerprint) -> IMP-005-A
- [x] Stocker les IPs connues par utilisateur -> IMP-005-A
- [x] Geolocalisation IP (pays, ville) -> IMP-005-B
- [x] Email d'alerte si nouvelle IP/device/pays -> IMP-005-C
- [x] Option "C'etait moi" dans l'email pour valider -> IMP-005-C
- [x] Option "Ce n'etait pas moi" pour revoquer sessions -> IMP-005-C
- [x] Historique des connexions visible dans profil -> IMP-005-D
- [x] Possibilite de revoquer des devices -> IMP-005-D
