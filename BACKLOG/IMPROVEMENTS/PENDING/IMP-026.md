# IMP-026: Configurer Service Worker skipWaiting PWA

**Type:** Improvement
**Statut:** A faire
**Priorite:** Moyenne
**Complexite:** XS
**Tags:** pwa, offline
**Date creation:** 2026-02-12

---

## Description

Le Service Worker est configure avec `skipWaiting: false`. Les nouvelles versions ne s'activent pas automatiquement — les utilisateurs restent bloques sur une vieille version jusqu'a fermeture complete de tous les onglets.

Le hook `usePWAUpdate` existe deja pour gerer les notifications de mise a jour.

## Criteres d'acceptation

- [ ] `skipWaiting: true` dans la config VitePWA
- [ ] `usePWAUpdate` gere le reload proprement apres activation
- [ ] L'utilisateur voit une notification "Mise a jour disponible" et peut recharger

## Fichiers concernes

- `apps/pwa/vite.config.ts:62` - skipWaiting: false
- `apps/pwa/src/hooks/usePWAUpdate.ts` - hook existant

## Analyse / Approche

```typescript
// vite.config.ts
workbox: {
  skipWaiting: true,
  clientsClaim: true,
}
```

Verifier que `usePWAUpdate` gere bien le cas `skipWaiting: true` (le SW s'active immediatement, donc le hook doit detecter l'activation et proposer un reload).

## Tests de validation

- [ ] Deployer une nouvelle version → l'ancienne se met a jour sans fermer l'onglet
- [ ] Notification de mise a jour visible
- [ ] Reload propre sans perte de donnees
