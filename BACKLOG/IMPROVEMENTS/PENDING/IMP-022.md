# IMP-022: Ajouter validation DTO sur endpoints de statut API

**Type:** Improvement
**Statut:** A faire
**Priorite:** Moyenne
**Complexite:** XS
**Tags:** api, security
**Date creation:** 2026-02-12

---

## Description

Plusieurs endpoints acceptent des parametres `string` bruts sans validation via DTO/enum. Exemple : `PATCH /chantiers/:id/statut` accepte n'importe quelle string pour le statut. Un appel avec un statut invalide peut corrompre les donnees.

## Criteres d'acceptation

- [ ] DTO avec `@IsEnum()` pour tous les endpoints de changement de statut
- [ ] Validation sur chantiers, devis, factures, interventions
- [ ] Erreur 400 claire si statut invalide

## Fichiers concernes

- `apps/api/src/modules/chantiers/chantiers.controller.ts:109` - @Body('statut') statut: string
- `apps/api/src/modules/devis/devis.controller.ts:144` - 'envoye' as any

## Analyse / Approche

```typescript
class UpdateStatutDto {
  @IsEnum(ChantierStatut)
  statut: ChantierStatut;
}

@Patch(':id/statut')
updateStatut(@Param('id') id: string, @Body() dto: UpdateStatutDto) {
  return this.chantiersService.updateStatut(id, dto.statut);
}
```

## Tests de validation

- [ ] PATCH /chantiers/:id/statut avec statut valide → 200
- [ ] PATCH /chantiers/:id/statut avec statut invalide → 400
- [ ] Meme chose pour devis, factures, interventions
